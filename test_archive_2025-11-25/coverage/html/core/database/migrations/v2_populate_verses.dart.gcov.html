<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - lcov.info - core/database/migrations/v2_populate_verses.dart</title>
  <link rel="stylesheet" type="text/css" href="../../../gcov.css">
</head>

<body>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="title">LCOV - code coverage report</td></tr>
            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>

            <tr>
              <td width="100%">
                <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="10%" class="headerValue"><a href="../../../index.html" title="Click to go to top-level">top level</a> - <a href="index.html" title="Click to go to directory core/database/migrations">core/database/migrations</a> - v2_populate_verses.dart</td>
            <td width="5%"></td>
            <td width="5%"></td>
            <td width="5%" class="headerCovTableHead">Coverage</td>
            <td width="5%" class="headerCovTableHead" title="Covered + Uncovered code">Total</td>
            <td width="5%" class="headerCovTableHead" title="Exercised code only">Hit</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">lcov.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntryLo">33.8&nbsp;%</td>
            <td class="headerCovTableEntry">68</td>
            <td class="headerCovTableEntry">23</td>
          </tr>
          <tr>
            <td class="headerItem">Test Date:</td>
            <td class="headerValue">2025-10-06 14:42:02</td>
            <td></td>
          </tr>
                  <tr><td><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
                </table>
              </td>
            </tr>

            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
          </table>

          <table cellpadding=0 cellspacing=0 border=0>
            <tr>
              <td><br></td>
            </tr>
            <tr>
              <td>
<pre class="sourceHeading">            Line data    Source code</pre>
<pre class="source">
<span id="L1"><span class="lineNum">       1</span>              : import 'dart:convert';</span>
<span id="L2"><span class="lineNum">       2</span>              : import 'package:flutter/services.dart' show rootBundle;</span>
<span id="L3"><span class="lineNum">       3</span>              : import 'package:sqflite/sqflite.dart';</span>
<span id="L4"><span class="lineNum">       4</span>              : </span>
<span id="L5"><span class="lineNum">       5</span>              : /// Migration to populate the database with Bible verses from JSON file</span>
<span id="L6"><span class="lineNum">       6</span>              : class PopulateVersesMigration {</span>
<span id="L7"><span class="lineNum">       7</span>              :   static const int version = 2;</span>
<span id="L8"><span class="lineNum">       8</span>              : </span>
<span id="L9"><span class="lineNum">       9</span>              :   /// Execute the migration to populate verses</span>
<span id="L10"><span class="lineNum">      10</span> <span class="tlaGNC">           1 :   static Future&lt;void&gt; migrate(Database db) async {</span></span>
<span id="L11"><span class="lineNum">      11</span> <span class="tlaGNC">           1 :     print('Running migration v2: Populating Bible verses...');</span></span>
<span id="L12"><span class="lineNum">      12</span>              : </span>
<span id="L13"><span class="lineNum">      13</span>              :     try {</span>
<span id="L14"><span class="lineNum">      14</span>              :       // Load verses from JSON file</span>
<span id="L15"><span class="lineNum">      15</span> <span class="tlaGNC">           2 :       final String versesJson = await rootBundle.loadString('assets/data/bible_verses.json');</span></span>
<span id="L16"><span class="lineNum">      16</span> <span class="tlaGNC">           1 :       final List&lt;dynamic&gt; versesData = jsonDecode(versesJson);</span></span>
<span id="L17"><span class="lineNum">      17</span>              : </span>
<span id="L18"><span class="lineNum">      18</span>              :       // Insert verses into database</span>
<span id="L19"><span class="lineNum">      19</span> <span class="tlaGNC">           1 :       await _insertVerses(db, versesData);</span></span>
<span id="L20"><span class="lineNum">      20</span>              : </span>
<span id="L21"><span class="lineNum">      21</span>              :       // Update verse search index</span>
<span id="L22"><span class="lineNum">      22</span> <span class="tlaGNC">           1 :       await _updateSearchIndex(db);</span></span>
<span id="L23"><span class="lineNum">      23</span>              : </span>
<span id="L24"><span class="lineNum">      24</span> <span class="tlaGNC">           3 :       print('✅ Migration v2 completed: ${versesData.length} verses inserted');</span></span>
<span id="L25"><span class="lineNum">      25</span>              :     } catch (e) {</span>
<span id="L26"><span class="lineNum">      26</span> <span class="tlaUNC">           0 :       print('❌ Migration v2 failed: $e');</span></span>
<span id="L27"><span class="lineNum">      27</span>              :       rethrow;</span>
<span id="L28"><span class="lineNum">      28</span>              :     }</span>
<span id="L29"><span class="lineNum">      29</span>              :   }</span>
<span id="L30"><span class="lineNum">      30</span>              : </span>
<span id="L31"><span class="lineNum">      31</span>              :   /// Insert verses into the database</span>
<span id="L32"><span class="lineNum">      32</span> <span class="tlaGNC">           1 :   static Future&lt;void&gt; _insertVerses(Database db, List&lt;dynamic&gt; versesData) async {</span></span>
<span id="L33"><span class="lineNum">      33</span> <span class="tlaGNC">           1 :     final batch = db.batch();</span></span>
<span id="L34"><span class="lineNum">      34</span>              : </span>
<span id="L35"><span class="lineNum">      35</span> <span class="tlaGNC">           2 :     for (final verseData in versesData) {</span></span>
<span id="L36"><span class="lineNum">      36</span>              :       final verse = verseData as Map&lt;String, dynamic&gt;;</span>
<span id="L37"><span class="lineNum">      37</span>              : </span>
<span id="L38"><span class="lineNum">      38</span>              :       // Create verse reference</span>
<span id="L39"><span class="lineNum">      39</span> <span class="tlaGNC">           4 :       final String reference = '${verse['book']} ${verse['chapter']}:${verse['verse']}';</span></span>
<span id="L40"><span class="lineNum">      40</span>              : </span>
<span id="L41"><span class="lineNum">      41</span>              :       // Convert themes list to JSON string</span>
<span id="L42"><span class="lineNum">      42</span> <span class="tlaGNC">           2 :       final String themesJson = jsonEncode(verse['themes'] ?? []);</span></span>
<span id="L43"><span class="lineNum">      43</span>              : </span>
<span id="L44"><span class="lineNum">      44</span> <span class="tlaGNC">           2 :       batch.insert('verses', {</span></span>
<span id="L45"><span class="lineNum">      45</span> <span class="tlaGNC">           1 :         'book': verse['book'],</span></span>
<span id="L46"><span class="lineNum">      46</span> <span class="tlaGNC">           1 :         'chapter': verse['chapter'],</span></span>
<span id="L47"><span class="lineNum">      47</span> <span class="tlaGNC">           1 :         'verse_number': verse['verse'],</span></span>
<span id="L48"><span class="lineNum">      48</span> <span class="tlaGNC">           1 :         'text': verse['text'],</span></span>
<span id="L49"><span class="lineNum">      49</span> <span class="tlaGNC">           1 :         'translation': verse['translation'] ?? 'ESV',</span></span>
<span id="L50"><span class="lineNum">      50</span>              :         'reference': reference,</span>
<span id="L51"><span class="lineNum">      51</span>              :         'themes': themesJson,</span>
<span id="L52"><span class="lineNum">      52</span> <span class="tlaGNC">           1 :         'category': verse['category'] ?? 'general',</span></span>
<span id="L53"><span class="lineNum">      53</span> <span class="tlaGNC">           2 :         'created_at': DateTime.now().millisecondsSinceEpoch,</span></span>
<span id="L54"><span class="lineNum">      54</span>              :       }, conflictAlgorithm: ConflictAlgorithm.ignore);</span>
<span id="L55"><span class="lineNum">      55</span>              :     }</span>
<span id="L56"><span class="lineNum">      56</span>              : </span>
<span id="L57"><span class="lineNum">      57</span> <span class="tlaGNC">           1 :     await batch.commit(noResult: true);</span></span>
<span id="L58"><span class="lineNum">      58</span>              :   }</span>
<span id="L59"><span class="lineNum">      59</span>              : </span>
<span id="L60"><span class="lineNum">      60</span>              :   /// Update the full-text search index with new verses</span>
<span id="L61"><span class="lineNum">      61</span> <span class="tlaGNC">           1 :   static Future&lt;void&gt; _updateSearchIndex(Database db) async {</span></span>
<span id="L62"><span class="lineNum">      62</span>              :     // The FTS table will automatically update through triggers</span>
<span id="L63"><span class="lineNum">      63</span>              :     // But we can optimize it manually if needed</span>
<span id="L64"><span class="lineNum">      64</span> <span class="tlaGNC">           1 :     await db.execute('INSERT INTO verses_fts(verses_fts) VALUES(&quot;optimize&quot;)');</span></span>
<span id="L65"><span class="lineNum">      65</span>              :   }</span>
<span id="L66"><span class="lineNum">      66</span>              : </span>
<span id="L67"><span class="lineNum">      67</span>              :   /// Add additional verse batches for comprehensive coverage</span>
<span id="L68"><span class="lineNum">      68</span> <span class="tlaUNC">           0 :   static Future&lt;void&gt; addMoreVerses(Database db) async {</span></span>
<span id="L69"><span class="lineNum">      69</span> <span class="tlaUNC">           0 :     final List&lt;Map&lt;String, dynamic&gt;&gt; additionalVerses = [</span></span>
<span id="L70"><span class="lineNum">      70</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L71"><span class="lineNum">      71</span>              :         'book': 'Psalm',</span>
<span id="L72"><span class="lineNum">      72</span>              :         'chapter': 91,</span>
<span id="L73"><span class="lineNum">      73</span>              :         'verse': 1,</span>
<span id="L74"><span class="lineNum">      74</span>              :         'text': 'He who dwells in the shelter of the Most High will abide in the shadow of the Almighty.',</span>
<span id="L75"><span class="lineNum">      75</span>              :         'translation': 'ESV',</span>
<span id="L76"><span class="lineNum">      76</span> <span class="tlaUNC">           0 :         'themes': ['protection', 'shelter', 'refuge', 'security'],</span></span>
<span id="L77"><span class="lineNum">      77</span>              :         'category': 'protection'</span>
<span id="L78"><span class="lineNum">      78</span>              :       },</span>
<span id="L79"><span class="lineNum">      79</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L80"><span class="lineNum">      80</span>              :         'book': 'Isaiah',</span>
<span id="L81"><span class="lineNum">      81</span>              :         'chapter': 40,</span>
<span id="L82"><span class="lineNum">      82</span>              :         'verse': 31,</span>
<span id="L83"><span class="lineNum">      83</span>              :         'text': 'But they who wait for the Lord shall renew their strength; they shall mount up with wings like eagles; they shall run and not be weary; they shall walk and not faint.',</span>
<span id="L84"><span class="lineNum">      84</span>              :         'translation': 'ESV',</span>
<span id="L85"><span class="lineNum">      85</span> <span class="tlaUNC">           0 :         'themes': ['strength', 'waiting', 'renewal', 'endurance'],</span></span>
<span id="L86"><span class="lineNum">      86</span>              :         'category': 'strength'</span>
<span id="L87"><span class="lineNum">      87</span>              :       },</span>
<span id="L88"><span class="lineNum">      88</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L89"><span class="lineNum">      89</span>              :         'book': 'Matthew',</span>
<span id="L90"><span class="lineNum">      90</span>              :         'chapter': 6,</span>
<span id="L91"><span class="lineNum">      91</span>              :         'verse': 26,</span>
<span id="L92"><span class="lineNum">      92</span>              :         'text': 'Look at the birds of the air: they neither sow nor reap nor gather into barns, and yet your heavenly Father feeds them. Are you not of more value than they?',</span>
<span id="L93"><span class="lineNum">      93</span>              :         'translation': 'ESV',</span>
<span id="L94"><span class="lineNum">      94</span> <span class="tlaUNC">           0 :         'themes': ['provision', 'value', 'worry', 'care'],</span></span>
<span id="L95"><span class="lineNum">      95</span>              :         'category': 'provision'</span>
<span id="L96"><span class="lineNum">      96</span>              :       },</span>
<span id="L97"><span class="lineNum">      97</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L98"><span class="lineNum">      98</span>              :         'book': 'Revelation',</span>
<span id="L99"><span class="lineNum">      99</span>              :         'chapter': 21,</span>
<span id="L100"><span class="lineNum">     100</span>              :         'verse': 4,</span>
<span id="L101"><span class="lineNum">     101</span>              :         'text': 'He will wipe away every tear from their eyes, and death shall be no more, neither shall there be mourning, nor crying, nor pain anymore, for the former things have passed away.',</span>
<span id="L102"><span class="lineNum">     102</span>              :         'translation': 'ESV',</span>
<span id="L103"><span class="lineNum">     103</span> <span class="tlaUNC">           0 :         'themes': ['comfort', 'eternal', 'healing', 'restoration'],</span></span>
<span id="L104"><span class="lineNum">     104</span>              :         'category': 'comfort'</span>
<span id="L105"><span class="lineNum">     105</span>              :       },</span>
<span id="L106"><span class="lineNum">     106</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L107"><span class="lineNum">     107</span>              :         'book': 'Ecclesiastes',</span>
<span id="L108"><span class="lineNum">     108</span>              :         'chapter': 3,</span>
<span id="L109"><span class="lineNum">     109</span>              :         'verse': 1,</span>
<span id="L110"><span class="lineNum">     110</span>              :         'text': 'For everything there is a season, and a time for every matter under heaven.',</span>
<span id="L111"><span class="lineNum">     111</span>              :         'translation': 'ESV',</span>
<span id="L112"><span class="lineNum">     112</span> <span class="tlaUNC">           0 :         'themes': ['timing', 'seasons', 'wisdom', 'patience'],</span></span>
<span id="L113"><span class="lineNum">     113</span>              :         'category': 'wisdom'</span>
<span id="L114"><span class="lineNum">     114</span>              :       },</span>
<span id="L115"><span class="lineNum">     115</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L116"><span class="lineNum">     116</span>              :         'book': 'Romans',</span>
<span id="L117"><span class="lineNum">     117</span>              :         'chapter': 12,</span>
<span id="L118"><span class="lineNum">     118</span>              :         'verse': 2,</span>
<span id="L119"><span class="lineNum">     119</span>              :         'text': 'Do not be conformed to this world, but be transformed by the renewal of your mind, that by testing you may discern what is the will of God, what is good and acceptable and perfect.',</span>
<span id="L120"><span class="lineNum">     120</span>              :         'translation': 'ESV',</span>
<span id="L121"><span class="lineNum">     121</span> <span class="tlaUNC">           0 :         'themes': ['transformation', 'mind', 'will', 'discernment'],</span></span>
<span id="L122"><span class="lineNum">     122</span>              :         'category': 'transformation'</span>
<span id="L123"><span class="lineNum">     123</span>              :       },</span>
<span id="L124"><span class="lineNum">     124</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L125"><span class="lineNum">     125</span>              :         'book': '1 Thessalonians',</span>
<span id="L126"><span class="lineNum">     126</span>              :         'chapter': 5,</span>
<span id="L127"><span class="lineNum">     127</span>              :         'verse': 16,</span>
<span id="L128"><span class="lineNum">     128</span>              :         'text': 'Rejoice always, pray without ceasing, give thanks in all circumstances; for this is the will of God in Christ Jesus for you.',</span>
<span id="L129"><span class="lineNum">     129</span>              :         'translation': 'ESV',</span>
<span id="L130"><span class="lineNum">     130</span> <span class="tlaUNC">           0 :         'themes': ['joy', 'prayer', 'gratitude', 'circumstances'],</span></span>
<span id="L131"><span class="lineNum">     131</span>              :         'category': 'gratitude'</span>
<span id="L132"><span class="lineNum">     132</span>              :       },</span>
<span id="L133"><span class="lineNum">     133</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L134"><span class="lineNum">     134</span>              :         'book': 'Psalm',</span>
<span id="L135"><span class="lineNum">     135</span>              :         'chapter': 139,</span>
<span id="L136"><span class="lineNum">     136</span>              :         'verse': 14,</span>
<span id="L137"><span class="lineNum">     137</span>              :         'text': 'I praise you, for I am fearfully and wonderfully made. Wonderful are your works; my soul knows it very well.',</span>
<span id="L138"><span class="lineNum">     138</span>              :         'translation': 'ESV',</span>
<span id="L139"><span class="lineNum">     139</span> <span class="tlaUNC">           0 :         'themes': ['identity', 'creation', 'worth', 'uniqueness'],</span></span>
<span id="L140"><span class="lineNum">     140</span>              :         'category': 'identity'</span>
<span id="L141"><span class="lineNum">     141</span>              :       },</span>
<span id="L142"><span class="lineNum">     142</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L143"><span class="lineNum">     143</span>              :         'book': 'John',</span>
<span id="L144"><span class="lineNum">     144</span>              :         'chapter': 3,</span>
<span id="L145"><span class="lineNum">     145</span>              :         'verse': 16,</span>
<span id="L146"><span class="lineNum">     146</span>              :         'text': 'For God so loved the world, that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.',</span>
<span id="L147"><span class="lineNum">     147</span>              :         'translation': 'ESV',</span>
<span id="L148"><span class="lineNum">     148</span> <span class="tlaUNC">           0 :         'themes': ['love', 'salvation', 'eternal', 'sacrifice'],</span></span>
<span id="L149"><span class="lineNum">     149</span>              :         'category': 'salvation'</span>
<span id="L150"><span class="lineNum">     150</span>              :       },</span>
<span id="L151"><span class="lineNum">     151</span> <span class="tlaUNC">           0 :       {</span></span>
<span id="L152"><span class="lineNum">     152</span>              :         'book': 'Psalm',</span>
<span id="L153"><span class="lineNum">     153</span>              :         'chapter': 119,</span>
<span id="L154"><span class="lineNum">     154</span>              :         'verse': 105,</span>
<span id="L155"><span class="lineNum">     155</span>              :         'text': 'Your word is a lamp to my feet and a light to my path.',</span>
<span id="L156"><span class="lineNum">     156</span>              :         'translation': 'ESV',</span>
<span id="L157"><span class="lineNum">     157</span> <span class="tlaUNC">           0 :         'themes': ['guidance', 'word', 'direction', 'light'],</span></span>
<span id="L158"><span class="lineNum">     158</span>              :         'category': 'guidance'</span>
<span id="L159"><span class="lineNum">     159</span>              :       }</span>
<span id="L160"><span class="lineNum">     160</span>              :     ];</span>
<span id="L161"><span class="lineNum">     161</span>              : </span>
<span id="L162"><span class="lineNum">     162</span> <span class="tlaUNC">           0 :     await _insertVerses(db, additionalVerses);</span></span>
<span id="L163"><span class="lineNum">     163</span> <span class="tlaUNC">           0 :     await _updateSearchIndex(db);</span></span>
<span id="L164"><span class="lineNum">     164</span>              :   }</span>
<span id="L165"><span class="lineNum">     165</span>              : </span>
<span id="L166"><span class="lineNum">     166</span>              :   /// Create thematic verse collections for quick access</span>
<span id="L167"><span class="lineNum">     167</span> <span class="tlaUNC">           0 :   static Future&lt;void&gt; createThematicCollections(Database db) async {</span></span>
<span id="L168"><span class="lineNum">     168</span>              :     // Create common theme collections</span>
<span id="L169"><span class="lineNum">     169</span> <span class="tlaUNC">           0 :     final themes = [</span></span>
<span id="L170"><span class="lineNum">     170</span>              :       'comfort',</span>
<span id="L171"><span class="lineNum">     171</span>              :       'strength',</span>
<span id="L172"><span class="lineNum">     172</span>              :       'hope',</span>
<span id="L173"><span class="lineNum">     173</span>              :       'guidance',</span>
<span id="L174"><span class="lineNum">     174</span>              :       'peace',</span>
<span id="L175"><span class="lineNum">     175</span>              :       'love',</span>
<span id="L176"><span class="lineNum">     176</span>              :       'faith',</span>
<span id="L177"><span class="lineNum">     177</span>              :       'courage',</span>
<span id="L178"><span class="lineNum">     178</span>              :       'purpose',</span>
<span id="L179"><span class="lineNum">     179</span>              :       'perseverance',</span>
<span id="L180"><span class="lineNum">     180</span>              :       'protection',</span>
<span id="L181"><span class="lineNum">     181</span>              :       'provision',</span>
<span id="L182"><span class="lineNum">     182</span>              :       'wisdom',</span>
<span id="L183"><span class="lineNum">     183</span>              :       'gratitude',</span>
<span id="L184"><span class="lineNum">     184</span>              :       'identity',</span>
<span id="L185"><span class="lineNum">     185</span>              :       'salvation'</span>
<span id="L186"><span class="lineNum">     186</span>              :     ];</span>
<span id="L187"><span class="lineNum">     187</span>              : </span>
<span id="L188"><span class="lineNum">     188</span> <span class="tlaUNC">           0 :     for (final theme in themes) {</span></span>
<span id="L189"><span class="lineNum">     189</span>              :       // Count verses for each theme</span>
<span id="L190"><span class="lineNum">     190</span> <span class="tlaUNC">           0 :       final result = await db.rawQuery(</span></span>
<span id="L191"><span class="lineNum">     191</span>              :         &quot;SELECT COUNT(*) as count FROM verses WHERE themes LIKE '%$theme%'&quot;</span>
<span id="L192"><span class="lineNum">     192</span> <span class="tlaUNC">           0 :       );</span></span>
<span id="L193"><span class="lineNum">     193</span> <span class="tlaUNC">           0 :       final count = result.first['count'] as int;</span></span>
<span id="L194"><span class="lineNum">     194</span>              : </span>
<span id="L195"><span class="lineNum">     195</span> <span class="tlaUNC">           0 :       print('Theme &quot;$theme&quot;: $count verses available');</span></span>
<span id="L196"><span class="lineNum">     196</span>              :     }</span>
<span id="L197"><span class="lineNum">     197</span>              :   }</span>
<span id="L198"><span class="lineNum">     198</span>              : </span>
<span id="L199"><span class="lineNum">     199</span>              :   /// Verify migration success</span>
<span id="L200"><span class="lineNum">     200</span> <span class="tlaUNC">           0 :   static Future&lt;bool&gt; verify(Database db) async {</span></span>
<span id="L201"><span class="lineNum">     201</span>              :     try {</span>
<span id="L202"><span class="lineNum">     202</span>              :       // Check total verse count</span>
<span id="L203"><span class="lineNum">     203</span> <span class="tlaUNC">           0 :       final result = await db.rawQuery('SELECT COUNT(*) as count FROM verses');</span></span>
<span id="L204"><span class="lineNum">     204</span> <span class="tlaUNC">           0 :       final count = result.first['count'] as int;</span></span>
<span id="L205"><span class="lineNum">     205</span>              : </span>
<span id="L206"><span class="lineNum">     206</span> <span class="tlaUNC">           0 :       if (count &lt; 20) {</span></span>
<span id="L207"><span class="lineNum">     207</span> <span class="tlaUNC">           0 :         print('❌ Verification failed: Expected at least 20 verses, found $count');</span></span>
<span id="L208"><span class="lineNum">     208</span>              :         return false;</span>
<span id="L209"><span class="lineNum">     209</span>              :       }</span>
<span id="L210"><span class="lineNum">     210</span>              : </span>
<span id="L211"><span class="lineNum">     211</span>              :       // Test FTS search</span>
<span id="L212"><span class="lineNum">     212</span> <span class="tlaUNC">           0 :       final searchResult = await db.rawQuery(</span></span>
<span id="L213"><span class="lineNum">     213</span>              :         &quot;SELECT * FROM verses_fts WHERE verses_fts MATCH 'strength' LIMIT 5&quot;</span>
<span id="L214"><span class="lineNum">     214</span>              :       );</span>
<span id="L215"><span class="lineNum">     215</span>              : </span>
<span id="L216"><span class="lineNum">     216</span> <span class="tlaUNC">           0 :       if (searchResult.isEmpty) {</span></span>
<span id="L217"><span class="lineNum">     217</span> <span class="tlaUNC">           0 :         print('❌ Verification failed: FTS search not working');</span></span>
<span id="L218"><span class="lineNum">     218</span>              :         return false;</span>
<span id="L219"><span class="lineNum">     219</span>              :       }</span>
<span id="L220"><span class="lineNum">     220</span>              : </span>
<span id="L221"><span class="lineNum">     221</span>              :       // Test theme filtering</span>
<span id="L222"><span class="lineNum">     222</span> <span class="tlaUNC">           0 :       final themeResult = await db.rawQuery(</span></span>
<span id="L223"><span class="lineNum">     223</span>              :         &quot;SELECT * FROM verses WHERE themes LIKE '%hope%' LIMIT 3&quot;</span>
<span id="L224"><span class="lineNum">     224</span>              :       );</span>
<span id="L225"><span class="lineNum">     225</span>              : </span>
<span id="L226"><span class="lineNum">     226</span> <span class="tlaUNC">           0 :       if (themeResult.isEmpty) {</span></span>
<span id="L227"><span class="lineNum">     227</span> <span class="tlaUNC">           0 :         print('❌ Verification failed: Theme filtering not working');</span></span>
<span id="L228"><span class="lineNum">     228</span>              :         return false;</span>
<span id="L229"><span class="lineNum">     229</span>              :       }</span>
<span id="L230"><span class="lineNum">     230</span>              : </span>
<span id="L231"><span class="lineNum">     231</span> <span class="tlaUNC">           0 :       print('✅ Migration v2 verification passed: $count verses, FTS working, themes working');</span></span>
<span id="L232"><span class="lineNum">     232</span>              :       return true;</span>
<span id="L233"><span class="lineNum">     233</span>              :     } catch (e) {</span>
<span id="L234"><span class="lineNum">     234</span> <span class="tlaUNC">           0 :       print('❌ Verification failed with error: $e');</span></span>
<span id="L235"><span class="lineNum">     235</span>              :       return false;</span>
<span id="L236"><span class="lineNum">     236</span>              :     }</span>
<span id="L237"><span class="lineNum">     237</span>              :   }</span>
<span id="L238"><span class="lineNum">     238</span>              : }</span>
        </pre>
              </td>
            </tr>
          </table>
          <br>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
            <tr><td class="versionInfo">Generated by: <a href="https://github.com//linux-test-project/lcov" target="_parent">LCOV version 2.3.2-1</a></td></tr>
          </table>
          <br>

</body>
</html>
